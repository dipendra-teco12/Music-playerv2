<section class="content-header">
  <h1>Song Details</h1>
</section>

<section class="content">
  <form id="uploadForm" enctype="multipart/form-data">
    <div class="card-body">
      <div class="row">
        <div class="col-sm-6">
          <!-- text input -->
          <div class="form-group">
            <label for="title"
              >Song title <span style="color: red">*</span></label
            >
            <input
              type="text"
              class="form-control"
              placeholder="Enter ..."
              name="title"
              title="title"
              id="title"
              required
            />
          </div>
        </div>

        <div class="col-sm-6">
          <div class="form-group">
            <label for="songImage">Song image</label>
            <div class="custom-file">
              <input
                type="file"
                class="custom-file-input"
                id="songImage"
                name="songImage"
              />
              <label class="custom-file-label" for="songImage"
                >Choose file</label
              >
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <!-- text input -->
          <div class="form-group">
            <label for="artistName">Artist Name</label>
            <input
              type="text"
              class="form-control"
              placeholder="Enter ..."
              name="artistName"
              id="artistName"
            />
          </div>
        </div>
        <div class="col-sm-6">
          <div class="form-group">
            <label for="artistImage">Artist image</label>
            <div class="custom-file">
              <input
                type="file"
                class="custom-file-input"
                id="artistImage"
                name="artistImage"
              />
              <label class="custom-file-label" for="artistImage"
                >Choose file</label
              >
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <!-- text input -->
          <div class="form-group">
            <label for="albumName">Album Name</label>
            <input
              type="text"
              class="form-control"
              placeholder="Enter ..."
              name="albumName"
              id="albumName"
            />
          </div>
        </div>
        <div class="col-sm-6">
          <div class="form-group">
            <label for="albumImage">Album image </label>
            <div class="custom-file">
              <input
                type="file"
                class="custom-file-input"
                id="albumImage"
                name="albumImage"
              />
              <label class="custom-file-label" for="albumImage"
                >Choose file</label
              >
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <div class="form-group">
            <label>Genres<span style="color: red">*</span></label>
            <select class="form-control" id="genreSelect">
              <option value="Classic Song">Classic Song</option>
              <option value="Rap Song">Rap Song</option>
              <option value="Pop Song">Pop Song</option>
              <option value="Rock Song">Rock Song</option>
            </select>
          </div>
        </div>
        <div class="col-sm-6">
          <div class="form-group">
            <label>Playlist<span style="color: red">*</span></label>
            <select class="form-control" id="playlistSelect">
              <option value="Chill Playlist">Chill Playlist</option>
              <option value="Sad Playlist">Sad Playlist</option>
              <option value="Workout Playlist">Workout Playlist</option>
              <option value="Love Playlist">Love Playlist</option>
              <option value="Happy Playlist">Happy Playlist</option>
            </select>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-6">
          <div class="form-group">
            <label for="Length">Audio Length</label>
            <input
              type="number"
              class="form-control"
              id="Length"
              name="length"
            />
          </div>
        </div>
        <div class="col-sm-6">
          <div class="form-group">
            <label for="audioFile"
              >Audio File<span style="color: red">*</span></label
            >
            <div class="custom-file">
              <input
                type="file"
                class="form-control"
                id="audioFile"
                name="audioFile"
                accept="audio/*"
                required
              />
              <label class="custom-file-label" for="audioFile"
                >Choose file</label
              >
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <div class="form-group">
            <label for="releaseDate">Release Date</label>
            <input
              type="date"
              class="form-control"
              id="releaseDate"
              name="releaseDate"
              required
            />
          </div>
        </div>
        <div class="col-sm-6">
          <!-- textarea -->
          <div class="form-group">
            <label>Description</label>
            <textarea
              class="form-control"
              rows="3"
              placeholder="Enter ..."
              name="description"
            ></textarea>
          </div>
        </div>
        <!-- <div class="col-sm-6">
          <div class="form-group">
            <label for="videoFile">Video File</label>
            <div class="custom-file">
              <input
                type="file"
                class="form-control"
                id="videoFile"
                name="videoFile"
                accept="video/*"
              />
              <label class="custom-file-label" for="videoFile"
                >Choose file</label
              >
            </div>
          </div>
        </div> -->
      </div>

      <button type="submit" class="btn btn-primary">Upload</button>
    </div>
  </form>
</section>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
  $(document).ready(function () {
    $("#uploadForm").on("submit", async function (e) {
      e.preventDefault();

      const formData = new FormData(this);
      formData.append("genre", $("#genreSelect").val());
      formData.append("playlist", $("#playlistSelect").val());
      // for (let [key, value] of formData.entries()) {
      //   console.log(`${key}:`, value);
      // }
      try {
        const response = await axios.post("/admin/upload", formData, {
          headers: {
            "Content-Type": "multipart/form-data",
          },
          withCredentials: true, // Ensure cookies are sent with the request
        });

        if (response.status === 200) {
          alert("Song uploaded successfully!");
          // Optionally reset form:
          // this.reset();
        }
      } catch (error) {
        console.error(
          "Upload error:",
          error.response?.data || error.message || error
        );

        alert(error.response?.data?.message || "Failed to upload song.");
      }
    });
  });
</script>
